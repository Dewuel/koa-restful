webpackJsonp([2],{"5C5c":function(e,t){},BO1k:function(e,t,r){e.exports={default:r("fxRn"),__esModule:!0}},DHMF:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("BO1k"),s=r.n(a),i=r("Xxa5"),o=r.n(i),l=r("exGp"),n=r.n(l),c=r("woOf"),u=r.n(c),d=r("zE1I"),f=r("5dNQ"),m={name:"userMgr",data:function(){return{dialogFormTitle:"",dialogFormUrl:"",dialogFormVisible:!1,defaultDptProps:{children:"children",label:"DPT_NAME"},defaultRoleProps:{children:"children",label:"ROLE_NAME"},userRoleIds:[],loading:!0,queryData:{currentPage:1,pageSize:20,searchDptKey:"",searchName:""},formRules:{USER_NAME:[{required:!0,message:"请输入名称",trigger:"blur"}],LOGIN_NAME:[{required:!0,message:"请输入名称",trigger:"blur"}],DPT_KEY:[{required:!0,message:"请输入名称",trigger:"change"}],USER_POSITION:[{required:!0,message:"请输入职位",trigger:"blur"}]},formFields:{USER_KEY:0,USER_NAME:"",LOGIN_NAME:"",USER_POSITION:"",USER_SEX:0,DPT_KEY:"",DPT_NAME:"",PHONE:""},formFieldsAdd:{},userMgDp:[],dptTree:[],roleTreeData:[],pageHeight:document.body.scrollHeight,initTbDataData:[],formLabelWidth:"80px"}},mounted:function(){this.initPage()},methods:{initPage:function(){this.formFieldsAdd=u()({},this.formFields),this.changeData(),this.initTbData(),this.getDptData(),this.getRoleData()},getDptData:function(){var e=this;return n()(o.a.mark(function t(){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.get("/system_mgr/dpt/getList",{});case 2:200==(r=t.sent).code&&r.data.length>0&&(e.userMgDp=r.data,e.dptTree=Object(f.a)(r.data,{idKey:"DPT_KEY",pidKey:"DPT_PKEY",rootPid:"0"}));case 4:case"end":return t.stop()}},t,e)}))()},initTbData:function(){var e=this;return n()(o.a.mark(function t(){var r,a,i,l,n,c,u,f;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.loading=!0,r={currentPage:e.queryData.currentPage,pageSize:e.queryData.pageSize,searchDptKey:e.queryData.searchDptKey,searchName:e.queryData.searchName},t.next=4,d.a.get("/system_mgr/user/getPageList",r);case 4:if(200!=(a=t.sent).code){t.next=27;break}for(e.initTbDataData=a.data,e.loading=!1,i=!0,l=!1,n=void 0,t.prev=11,c=s()(e.initTbDataData.data);!(i=(u=c.next()).done);i=!0)0==(f=u.value).Fsex?f.Fsex="男":f.Fsex="女";t.next=19;break;case 15:t.prev=15,t.t0=t.catch(11),l=!0,n=t.t0;case 19:t.prev=19,t.prev=20,!i&&c.return&&c.return();case 22:if(t.prev=22,!l){t.next=25;break}throw n;case 25:return t.finish(22);case 26:return t.finish(19);case 27:case"end":return t.stop()}},t,e,[[11,15,19,27],[20,,22,26]])}))()},saveRoles:function(){var e=this;return n()(o.a.mark(function t(){var r,a,i,l,n,c,u,f,m;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e.formFields.USER_KEY){t.next=4;break}return t.abrupt("return",e.$message.error("请选择用户！"));case 4:for(r=e.$refs.roleTree.getCheckedNodes(),a=[],i=!0,l=!1,n=void 0,t.prev=9,c=s()(r);!(i=(u=c.next()).done);i=!0)f=u.value,a.push(f.ROLE_KEY);t.next=17;break;case 13:t.prev=13,t.t0=t.catch(9),l=!0,n=t.t0;case 17:t.prev=17,t.prev=18,!i&&c.return&&c.return();case 20:if(t.prev=20,!l){t.next=23;break}throw n;case 23:return t.finish(20);case 24:return t.finish(17);case 25:return m={USER_KEY:e.formFields.USER_KEY,ROLE_KEYS:a},t.next=28,d.a.get("/system_mgr/user/updUserRole",m);case 28:200==t.sent.code&&(e.formFields.USER_KEY=null,e.$message.success("操作成功！"));case 30:case"end":return t.stop()}},t,e,[[9,13,17,25],[18,,20,24]])}))()},getUserRoles:function(){var e=this;return n()(o.a.mark(function t(){var r,a,s,i;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!==e.formFields.USER_KEY){t.next=4;break}return t.abrupt("return",e.$message.error("请选择用户！"));case 4:return r={USER_KEY:e.formFields.USER_KEY},t.next=7,d.a.get("/system_mgr/user/getRoleListByUserKey",r);case 7:200==(a=t.sent).code&&(s=a.data,i=[],s.forEach(function(e,t){i.push(e.ROLE_KEY)}),e.$refs.roleTree.setCheckedKeys(i));case 9:case"end":return t.stop()}},t,e)}))()},getRoleData:function(){var e=this;return n()(o.a.mark(function t(){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.a.get("/system_mgr/role/getList",{});case 2:200==(r=t.sent).code&&(e.roleTreeData=r.data);case 4:case"end":return t.stop()}},t,e)}))()},sleTableRow:function(e){this.formFields=e,this.getUserRoles()},monitorOption:function(e){this.formFieldsAdd.FdptId=e},clickTree:function(e){this.queryData.searchDptKey=e.DPT_KEY,this.initTbData()},getSelectTableRow:function(){return this.$refs.singleTable.store.states.currentRow},add:function(){this.formFields=u()({},this.formFieldsAdd),this.dialogFormTitle="添加用户",this.dialogFormVisible=!0,this.dialogFormUrl="/system_mgr/user/add"},edit:function(){if(this.formFields=u()({},this.getSelectTableRow()),null==this.formFields.USER_KEY)return this.$message.error("请选择要编辑的用户！");this.dialogFormTitle="修改用户",this.dialogFormVisible=!0,this.dialogFormUrl="/system_mgr/user/update"},addOrEditSubmit:function(e){var t,r=this;this.$refs[e].validate((t=n()(o.a.mark(function e(t){return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}return e.next=3,d.a.post(r.dialogFormUrl,r.formFields);case 3:200==e.sent.code&&(r.initTbData(),r.dialogFormVisible=!1,r.$message.success("提交成功！")),e.next=9;break;case 7:return console.log("error submit!!"),e.abrupt("return",!1);case 9:case"end":return e.stop()}},e,r)})),function(e){return t.apply(this,arguments)}))},del:function(){var e=this;if(null===this.formFields.USER_KEY)return this.$message.error("请选择要删除的用户！");this.$confirm("确认删除该用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(n()(o.a.mark(function t(){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={USER_KEY:e.formFields.USER_KEY},t.next=3,d.a.delete("/system_mgr/user/delete",r);case 3:200==t.sent.code&&(e.initTbData(),e.$message.success("操作成功！"));case 5:case"end":return t.stop()}},t,e)}))).catch(function(){})},userMgResetPw:function(){var e=this;if(null===this.formFields.USER_KEY)return this.$message.error("请选择用户！");this.$confirm("是否要重置该用户密码为“123456”?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(n()(o.a.mark(function t(){var r;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={USER_KEY:e.formFields.USER_KEY},t.next=3,d.a.get("/system_mgr/user/resetPwdByUserKey",r);case 3:200==t.sent.code&&(e.initTbData(),e.$message.success("操作成功！"));case 5:case"end":return t.stop()}},t,e)}))).catch(function(){})},pageSizeChange:function(e){this.queryData.pageSize=e,this.initTbData()},pageCurrentChange:function(e){this.queryData.currentPage=e,this.initTbData()}}},p={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"userMgr"},[r("div",{staticClass:"dptTree"},[r("div",{staticClass:"dptTree-title"},[e._v("部门科室树")]),e._v(" "),r("el-tree",{ref:"dptTree",attrs:{data:e.dptTree,"node-key":"Fid",props:e.defaultDptProps,"default-expand-all":"","expand-on-click-node":!1,"highlight-current":!0},on:{"node-click":e.clickTree}})],1),e._v(" "),r("div",{staticClass:"container"},[r("div",{staticClass:"search-bar"},[r("el-form",{ref:"searchForm",attrs:{model:e.queryData,inline:!0}},[r("el-form-item",{attrs:{label:"姓名"}},[r("el-input",{attrs:{placeholder:"请输入搜索内容"},model:{value:e.queryData.searchName,callback:function(t){e.$set(e.queryData,"searchName",t)},expression:"queryData.searchName"}})],1),e._v(" "),r("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.initTbData}},[e._v("搜索")])],1)],1),e._v(" "),r("div",{staticClass:"table"},[r("div",{staticClass:"table-toolbar"},[r("ul",[r("li",{staticStyle:{display:"none"},attrs:{id:"/system_mgr/user/add"},on:{click:e.add}},[r("i",{staticClass:"el-icon-plus"}),e._v("增加\n          ")]),e._v(" "),r("li",{staticStyle:{display:"none"},attrs:{id:"/system_mgr/user/update"},on:{click:e.edit}},[r("i",{staticClass:"el-icon-edit-outline"}),e._v("修改\n          ")]),e._v(" "),r("li",{staticStyle:{display:"none"},attrs:{id:"/system_mgr/user/resetMyPwd"},on:{click:e.userMgResetPw}},[r("i",{staticClass:"el-icon-setting"}),e._v("重置密码\n          ")]),e._v(" "),r("li",{staticStyle:{display:"none"},attrs:{id:"/system_mgr/user/delete"},on:{click:e.del}},[r("i",{staticClass:"el-icon-minus"}),e._v("删除\n          ")]),e._v(" "),r("li",{on:{click:e.initTbData}},[r("i",{staticClass:"el-icon-refresh"}),e._v("刷新\n          ")])])]),e._v(" "),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"singleTable",staticClass:"table-style",attrs:{"tooltip-effect":"dark","highlight-current-row":"","max-height":this.pageHeight-200,border:"",data:e.initTbDataData.data},on:{"row-click":e.sleTableRow}},[r("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"LOGIN_NAME",label:"账号","min-width":"80",width:"auto"}}),e._v(" "),r("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"USER_NAME",label:"姓名","min-width":"80",width:"auto"}}),e._v(" "),r("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"USER_SEX",label:"性别",formatter:e.sexFormatter,"min-width":"60",width:"auto"}}),e._v(" "),r("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"DPT_NAME",label:"部门","min-width":"80",width:"auto"}}),e._v(" "),r("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"USER_POSITION",label:"职位",width:"auto","min-width":"80"}}),e._v(" "),r("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"PHONE",label:"联系电话",width:"auto","min-width":"100"}}),e._v(" "),r("el-table-column",{attrs:{"show-overflow-tooltip":"",prop:"TIME_MODIFY",label:"时间",width:"auto","min-width":"130"}})],1),e._v(" "),r("el-pagination",{ref:"pagination",attrs:{background:"","pager-count":5,small:!0,"current-page":e.queryData.currentPage,"page-sizes":[10,20,30,40,50,60,70,80,90],"page-size":e.queryData.pageSize,layout:"total ,sizes, prev, pager, next, jumper",total:e.initTbDataData.total},on:{"size-change":e.pageSizeChange,"current-change":e.pageCurrentChange}})],1)]),e._v(" "),r("div",{staticClass:"roleTree"},[r("div",{staticClass:"roleTree-content"},[r("div",{staticClass:"roleTree-title"},[e._v("角色树")]),e._v(" "),r("el-tree",{ref:"roleTree",attrs:{data:e.roleTreeData,"default-expand-all":"","node-key":"ROLE_KEY",props:e.defaultRoleProps,"expand-on-click-node":!1,"show-checkbox":""}}),e._v(" "),r("div",{staticClass:"roleTree-submit"},[r("el-button",{attrs:{type:"primary",size:"size",icon:"el-icon-success"},on:{click:e.saveRoles}},[e._v("保存")])],1)],1)]),e._v(" "),r("div",{staticClass:"userGroupTree"},[r("div",{staticClass:"userGroupTree-content"},[r("div",{staticClass:"userGroupTree-title"},[e._v("用户组树")]),e._v(" "),r("el-tree",{ref:"userGroupTree",attrs:{data:e.roleTreeData,"default-expand-all":"","node-key":"ROLE_KEY",props:e.defaultRoleProps,"expand-on-click-node":!1,"show-checkbox":""}}),e._v(" "),r("div",{staticClass:"userGroupTree-submit"},[r("el-button",{attrs:{type:"primary",size:"size",icon:"el-icon-success"},on:{click:e.saveRoles}},[e._v("保存")])],1)],1)]),e._v(" "),r("el-dialog",{attrs:{title:e.dialogFormTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"formFields",attrs:{model:e.formFields,rules:e.formRules}},[r("el-form-item",{attrs:{label:"姓名","label-width":e.formLabelWidth,prop:"USER_NAME"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formFields.USER_NAME,callback:function(t){e.$set(e.formFields,"USER_NAME",t)},expression:"formFields.USER_NAME"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"账号","label-width":e.formLabelWidth,prop:"LOGIN_NAME"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formFields.LOGIN_NAME,callback:function(t){e.$set(e.formFields,"LOGIN_NAME",t)},expression:"formFields.LOGIN_NAME"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"性别","label-width":e.formLabelWidth,prop:"USER_SEX"}},[r("el-radio-group",{model:{value:e.formFields.USER_SEX,callback:function(t){e.$set(e.formFields,"USER_SEX",t)},expression:"formFields.USER_SEX"}},[r("el-radio",{attrs:{label:0}},[e._v("男")]),e._v(" "),r("el-radio",{attrs:{label:1}},[e._v("女")])],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"部门","label-width":e.formLabelWidth,prop:"DPT_NAME"}},[r("el-select",{attrs:{placeholder:"请选择"},on:{change:e.monitorOption},model:{value:e.formFields.DPT_KEY,callback:function(t){e.$set(e.formFields,"DPT_KEY",t)},expression:"formFields.DPT_KEY"}},e._l(e.userMgDp,function(e){return r("el-option",{key:e.DPT_KEY,attrs:{label:e.DPT_NAME,value:e.DPT_KEY}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"职位","label-width":e.formLabelWidth,prop:"USER_POSITION"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formFields.USER_POSITION,callback:function(t){e.$set(e.formFields,"USER_POSITION",t)},expression:"formFields.USER_POSITION"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"联系电话","label-width":e.formLabelWidth}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formFields.PHONE,callback:function(t){e.$set(e.formFields,"PHONE",t)},expression:"formFields.PHONE"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addOrEditSubmit("formFields")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var h=r("VU/8")(m,p,!1,function(e){r("5C5c")},null,null);t.default=h.exports},fxRn:function(e,t,r){r("+tPU"),r("zQR9"),e.exports=r("g8Ux")},g8Ux:function(e,t,r){var a=r("77Pl"),s=r("3fs2");e.exports=r("FeBl").getIterator=function(e){var t=s(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return a(t.call(e))}}});
//# sourceMappingURL=2.ce7ee431e2145c5df7af.js.map