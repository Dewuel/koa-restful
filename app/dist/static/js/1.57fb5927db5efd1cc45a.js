webpackJsonp([1],{"5q0h":function(e,t){},BO1k:function(e,t,r){e.exports={default:r("fxRn"),__esModule:!0}},fxRn:function(e,t,r){r("+tPU"),r("zQR9"),e.exports=r("g8Ux")},g8Ux:function(e,t,r){var n=r("77Pl"),s=r("3fs2");e.exports=r("FeBl").getIterator=function(e){var t=s(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},wy9z:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("BO1k"),s=r.n(n),a=r("mvHQ"),i=r.n(a),o=r("Xxa5"),l=r.n(o),c=r("exGp"),u=r.n(c),d=r("woOf"),f=r.n(d),p=r("zE1I"),m=r("5dNQ"),h={name:"roleSysMge",data:function(){return{dialogFormTitle:"",dialogFormUrl:"",dialogFormVisible:!1,contextMenuData:{menuName:"demo",axios:{x:null,y:null},menulists:[{fnHandler:"savedata",icoName:"el-icon-edit-outline",btnName:"修改"},{fnHandler:"newdata",icoName:"el-icon-minus",btnName:"删除"}]},defaultRoleProps:{children:"children",label:"ROLE_NAME"},defaultMenuProps:{children:"children",label:"MENU_NAME"},defaultOperProps:{children:"children",label:"OPER_NAME"},formRules:{ROLE_NAME:[{required:!0,message:"请输入名称",trigger:"blur"}]},formFields:{ROLE_KEY:null,ROLE_NAME:"",DESCRIPT:""},formFieldsAdd:{},menuTreeData:[],operTreeData:[],formLabelWidth:"80px",loadingRole:!0,loadingMenu:!0,loadingOper:!0,roleTreeData:[],showCk:!1,showBj:!1,th785:785}},mounted:function(){this.initPage()},methods:{initPage:function(){this.formFieldsAdd=f()({},this.formFields),this.getRoleList(),this.initMenuData(),this.initOperData()},showMenu:function(e,t,r,n){console.info(t),this.formFields=f()({},t),e.preventDefault();var s=e.clientX,a=e.clientY;this.contextMenuData.axios={x:s,y:a}},getRoleList:function(){var e=this;return u()(l.a.mark(function t(){var r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.formFields.ROLE_KEY=null,t.next=3,p.a.get("/system_mgr/role/getList",{});case 3:200==(r=t.sent).code&&(e.roleTreeData=r.data),e.loadingRole=!1;case 6:case"end":return t.stop()}},t,e)}))()},initMenuData:function(){var e=this;return u()(l.a.mark(function t(){var r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.get("/system_mgr/menu/getList",{});case 2:200==(r=t.sent).code&&(e.menuTreeData=Object(m.a)(r.data,{idKey:"MENU_KEY",pidKey:"MENU_PKEY",rootPid:"0"})),e.loadingMenu=!1;case 5:case"end":return t.stop()}},t,e)}))()},initOperData:function(){var e=this;return u()(l.a.mark(function t(){var r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,p.a.get("/system_mgr/oper/getList",{});case 2:200==(r=t.sent).code&&(e.operTreeData=Object(m.a)(r.data,{idKey:"OPER_KEY",pidKey:"OPER_PKEY",rootPid:"0"})),e.loadingOper=!1;case 5:case"end":return t.stop()}},t,e)}))()},saveMenuConfig:function(){var e=this;return u()(l.a.mark(function t(){var r,n,a,o,c,u,d,f,m,h;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(r=e.$refs.roleTree.getCurrentNode())){t.next=5;break}return t.abrupt("return",e.$message.error("请选择角色！"));case 5:for(n=e.$refs.menuTree.getCheckedNodes(),a=[],o=!0,c=!1,u=void 0,t.prev=10,d=s()(n);!(o=(f=d.next()).done);o=!0)m=f.value,a.push(m.MENU_KEY);t.next=18;break;case 14:t.prev=14,t.t0=t.catch(10),c=!0,u=t.t0;case 18:t.prev=18,t.prev=19,!o&&d.return&&d.return();case 21:if(t.prev=21,!c){t.next=24;break}throw u;case 24:return t.finish(21);case 25:return t.finish(18);case 26:return h={ROLE_KEY:r.ROLE_KEY,RESOURCE_KEYS:i()(a),RESOURCE_TYPE:0},console.info(h),t.next=30,p.a.get("/system_mgr/role/updRolePermission",h);case 30:200==t.sent.code&&e.$message.success("操作成功！");case 32:case"end":return t.stop()}},t,e,[[10,14,18,26],[19,,21,25]])}))()},saveOperConfig:function(){var e=this;return u()(l.a.mark(function t(){var r,n,a,o,c,u,d,f,m,h;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(r=e.$refs.roleTree.getCurrentNode())){t.next=5;break}return t.abrupt("return",e.$message.error("请选择角色！"));case 5:for(n=e.$refs.operTree.getCheckedNodes(),a=[],o=!0,c=!1,u=void 0,t.prev=10,d=s()(n);!(o=(f=d.next()).done);o=!0)m=f.value,a.push(m.OPER_KEY);t.next=18;break;case 14:t.prev=14,t.t0=t.catch(10),c=!0,u=t.t0;case 18:t.prev=18,t.prev=19,!o&&d.return&&d.return();case 21:if(t.prev=21,!c){t.next=24;break}throw u;case 24:return t.finish(21);case 25:return t.finish(18);case 26:return h={ROLE_KEY:r.ROLE_KEY,RESOURCE_KEYS:i()(a),RESOURCE_TYPE:1},t.next=29,p.a.get("/system_mgr/role/updRolePermission",h);case 29:200==t.sent.code&&e.$message.success("操作成功！");case 31:case"end":return t.stop()}},t,e,[[10,14,18,26],[19,,21,25]])}))()},selRoleTree:function(){this.$refs.menuTree.setCheckedKeys([]),this.$refs.operTree.setCheckedKeys([]);var e=this.$refs.roleTree.getCurrentNode();this.getRoleMenuList(e.ROLE_KEY)},getRoleMenuList:function(e){var t=this;return u()(l.a.mark(function r(){var n,s,a,i,o;return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return n={ROLE_KEY:e},r.next=3,p.a.get("/system_mgr/role/getRoleMenuAndOperList",n);case 3:s=r.sent,a=s.data,200==s.code&&(i=[],o=[],a.forEach(function(e,t){0===e.RESOURCE_TYPE?i.push(e.RESOURCE_KEY):o.push(e.RESOURCE_KEY)}),t.$refs.menuTree.setCheckedKeys(i),t.$refs.operTree.setCheckedKeys(o));case 6:case"end":return r.stop()}},r,t)}))()},renderMenuContent:function(e,t){t.node;var r=t.data,n=(t.store,arguments[0]);return"0"==r.Fid?n("span",[n("span","    "+r.MENU_NAME)]):n("span",[n("i",{attrs:{class:r.MENU_ICON}}),n("span","    "+r.MENU_NAME)])},renderContentRole:function(e,t){t.node;var r=t.data,n=(t.store,arguments[0]),s=r.type;return-1===s?n("span",[n("span","     "+r.label)]):0===s?n("span",[n("i",{attrs:{class:"fa  fa-tag"}}),n("span","     "+r.label)]):1===s?n("span",[n("i",{attrs:{class:"fa fa-rocket"}}),n("span","     "+r.label)]):2===s?n("span",[n("i",{attrs:{class:"fa fa-bell"}}),n("span","     "+r.label)]):3===s?n("span",[n("i",{attrs:{class:"fa fa-user-o"}}),n("span","     "+r.label)]):void 0},renderContentOper:function(e,t){t.node;var r=t.data,n=(t.store,arguments[0]);return"0"==r.OPER_KEY?n("span",[n("span",r.OPER_NAME)]):0==r.OPER_TYPE?n("span",[n("i",{attrs:{class:"fa fa-hand-o-up"}}),n("span","     "),n("span",r.OPER_NAME)]):n("span",[n("span",r.OPER_NAME)])},add:function(){this.formFields=f()({},this.formFieldsAdd),this.dialogFormTitle="添加角色",this.dialogFormUrl="/system_mgr/role/add",this.dialogFormVisible=!0},edit:function(){if(null==this.formFields.ROLE_KEY)return this.$message.error("请选择要编辑的角色！");this.dialogFormTitle="编辑角色",this.dialogFormUrl="/system_mgr/role/update",this.dialogFormVisible=!0},addOrEditSubmit:function(e){var t,r=this;this.$refs[e].validate((t=u()(l.a.mark(function t(n){return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=7;break}return t.next=3,p.a.post(r.dialogFormUrl,r.formFields);case 3:200==t.sent.code&&(r.resetForm(e),r.getRoleList(),r.dialogFormVisible=!1,r.$message.success("提交成功！")),t.next=9;break;case 7:return console.log("error submit!!"),t.abrupt("return",!1);case 9:case"end":return t.stop()}},t,r)})),function(e){return t.apply(this,arguments)}))},del:function(){var e=this,t=this.$refs.roleTree.getCurrentNode();if(null==t)return this.$message.error("请选择要删除的节点！");this.$confirm("确认删除该数据?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(u()(l.a.mark(function r(){return l.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.delete("/system_mgr/role/delete",{ROLE_KEY:t.ROLE_KEY});case 2:200==r.sent.code&&(e.getRoleList(),e.$message.success("删除成功！"));case 4:case"end":return r.stop()}},r,e)}))).catch(function(){})},resetForm:function(e){this.$refs[e].resetFields()}}},v={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"roleSysMge"},[r("div",{staticClass:"log-main"},[r("div",{staticClass:"table-content clearfix"},[r("div",{staticClass:"roleTree set-left"},[r("div",{staticClass:"roleTree-content"},[r("div",{staticClass:"roleTree-title"},[r("span",{staticStyle:{"margin-right":"20px"}},[e._v("角色管理")]),e._v(" "),r("el-button",{attrs:{icon:"el-icon-plus",size:"size"},on:{click:e.add}},[e._v("添加")])],1),e._v(" "),r("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingRole,expression:"loadingRole"}],ref:"roleTree",attrs:{"default-expand-all":"","expand-on-click-node":!1,data:e.roleTreeData,"node-key":"ROLE_KEY",props:e.defaultRoleProps},on:{"node-contextmenu":e.showMenu,"node-click":e.selRoleTree}}),e._v(" "),r("vue-context-menu",{attrs:{contextMenuData:e.contextMenuData},on:{savedata:e.edit,newdata:e.del}})],1)]),e._v(" "),r("div",{staticClass:"menuTree set-right"},[r("div",{staticClass:"roleTree-content"},[e._m(0),e._v(" "),r("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingMenu,expression:"loadingMenu"}],ref:"menuTree",attrs:{"show-checkbox":"","default-expand-all":"","check-strictly":!0,"expand-on-click-node":!1,data:e.menuTreeData,"render-content":e.renderMenuContent,"node-key":"MENU_KEY",props:e.defaultMenuProps}}),e._v(" "),r("div",{staticClass:"roleSysMge-submit"},[r("el-button",{attrs:{type:"primary",size:"size",icon:"el-icon-success"},on:{click:e.saveMenuConfig}},[e._v("保存")])],1)],1)]),e._v(" "),r("div",{staticClass:"operTree set-right"},[r("div",{staticClass:"roleTree-content"},[e._m(1),e._v(" "),r("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingOper,expression:"loadingOper"}],ref:"operTree",attrs:{"show-checkbox":"","default-expand-all":"","check-strictly":!0,"expand-on-click-node":!1,data:e.operTreeData,"render-content":e.renderContentOper,"node-key":"OPER_KEY",props:e.defaultOperProps}}),e._v(" "),r("div",{staticClass:"roleSysMge-submit"},[r("el-button",{attrs:{type:"primary",size:"size",icon:"el-icon-success"},on:{click:e.saveOperConfig}},[e._v("保存")])],1)],1)])])]),e._v(" "),r("el-dialog",{attrs:{title:e.dialogFormTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[r("el-form",{ref:"formFields",attrs:{model:e.formFields,formRules:e.formRules}},[r("el-form-item",{attrs:{label:"名称","label-width":e.formLabelWidth,prop:"ROLE_NAME"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formFields.ROLE_NAME,callback:function(t){e.$set(e.formFields,"ROLE_NAME",t)},expression:"formFields.ROLE_NAME"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"描述","label-width":e.formLabelWidth,prop:"DESCRIPT"}},[r("el-input",{attrs:{"auto-complete":"off"},model:{value:e.formFields.DESCRIPT,callback:function(t){e.$set(e.formFields,"DESCRIPT",t)},expression:"formFields.DESCRIPT"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addOrEditSubmit("formFields")}}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"roleTree-title"},[t("span",{staticStyle:{height:"32px","line-height":"32px"}},[this._v("菜单预览")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"roleTree-title"},[t("span",{staticStyle:{height:"32px","line-height":"32px"}},[this._v("操作预览")])])}]};var E=r("VU/8")(h,v,!1,function(e){r("5q0h")},null,null);t.default=E.exports}});
//# sourceMappingURL=1.57fb5927db5efd1cc45a.js.map